###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.50.3.4676/W32 for ARM      13/Sep/2017  18:09:22 #
# Copyright 1999-2013 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\repositorios\MaisPipocaG2\SOFTWARE\Drivers\MDB\mdb_ca #
#                    shless.c                                                 #
#    Command line =  C:\repositorios\MaisPipocaG2\SOFTWARE\Drivers\MDB\mdb_ca #
#                    shless.c -lC C:\repositorios\MaisPipocaG2\SOFTWARE\Debug #
#                    \List\ -lA C:\repositorios\MaisPipocaG2\SOFTWARE\Debug\L #
#                    ist\ -o C:\repositorios\MaisPipocaG2\SOFTWARE\Debug\Obj\ #
#                     --no_cse --no_unroll --no_inline --no_code_motion       #
#                    --no_tbaa --no_clustering --no_scheduling --debug        #
#                    --endian=little --cpu=Cortex-M3 -e --fpu=None            #
#                    --dlib_config "C:\Program Files (x86)\IAR                #
#                    Systems\Embedded Workbench 6.5\arm\INC\c\DLib_Config_Nor #
#                    mal.h" -On                                               #
#    List file    =  C:\repositorios\MaisPipocaG2\SOFTWARE\Debug\List\mdb_cas #
#                    hless.lst                                                #
#    Object file  =  C:\repositorios\MaisPipocaG2\SOFTWARE\Debug\Obj\mdb_cash #
#                    less.o                                                   #
#                                                                             #
#                                                                             #
###############################################################################

C:\repositorios\MaisPipocaG2\SOFTWARE\Drivers\MDB\mdb_cashless.c
      1          /*__________________________________________________________________________________
      2          |	Quark Tecnologia Eletrônica Embarcada
      3          |       
      4          |       Itapema - SC
      5          |       www.quarktee.com.br
      6          | __________________________________________________________________________________
      7          |
      8          |       This source code was developed by Quark  and cannot be copied, in part 
      9          |       or in whole, or used, except when legally licensed by Quark 
     10          |       or its distributors.
     11          |
     12          |       Este código é propriedade da Quark  e não pode ser copiado, em parte 
     13          |       ou em todo, ou utilizado, exceto quando for legalmente licenciado pela 
     14          |       Quark  ou por um de seus distribuidores.
     15          | __________________________________________________________________________________
     16          |
     17          |       Arquivo            :  mdb_cashless.c
     18          | 
     19          |       Autor              :  Marcos Aquino
     20          |       Data criação       :  27/02/2017
     21          |
     22          |       Revisões           :  001
     23          |
     24          |
     25          | __________________________________________________________________________________
     26          */
     27          
     28          /***********************************************************************************
     29          *       Includes
     30          ***********************************************************************************/
     31          #include <stdio.h>
     32          #include <stdlib.h>
     33          #include <string.h>
     34          #include "mdb_uart.h"
     35          #include "mdb.h"
     36          #include "mdb_cashless.h"
     37          
     38          
     39          /***********************************************************************************
     40          *       Definições
     41          ***********************************************************************************/
     42          
     43          
     44          /***********************************************************************************
     45          *       Variaveis locais
     46          ***********************************************************************************/
     47          
     48          
     49          /***********************************************************************************
     50          *       Funções locais
     51          ***********************************************************************************/
     52          
     53          
     54          /***********************************************************************************
     55          *       Implementação das funções
     56          ***********************************************************************************/
     57          
     58          /***********************************************************************************
     59          *       Descrição       :       Verifica se o dispositivo está presente
     60          *                               no barramento
     61          *       Parametros      :       nenhum
     62          *       Retorno         :       (eMDB_reply) resultado
     63          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     64          eMDB_reply CASHLESS_adreess(void){
   \                     CASHLESS_adreess:
   \   00000000   0xB5E0             PUSH     {R5-R7,LR}
     65            unsigned char buffer[2];
     66            unsigned char recebidos;
     67            
     68            buffer[0] = MDB_CASHLESS_DEVICE;
   \   00000002   0x2010             MOVS     R0,#+16
   \   00000004   0xF88D 0x0008      STRB     R0,[SP, #+8]
     69            
     70            if(MDB_send_package(1,buffer,1,0,buffer,&recebidos)==MDB_OK){
   \   00000008   0xF10D 0x000A      ADD      R0,SP,#+10
   \   0000000C   0x9001             STR      R0,[SP, #+4]
   \   0000000E   0xA802             ADD      R0,SP,#+8
   \   00000010   0x9000             STR      R0,[SP, #+0]
   \   00000012   0x2300             MOVS     R3,#+0
   \   00000014   0x2201             MOVS     R2,#+1
   \   00000016   0xA902             ADD      R1,SP,#+8
   \   00000018   0x2001             MOVS     R0,#+1
   \   0000001A   0x.... 0x....      BL       MDB_send_package
   \   0000001E   0x2800             CMP      R0,#+0
   \   00000020   0xD107             BNE.N    ??CASHLESS_adreess_0
     71                  
     72              if(buffer[0]==MDB_RESP_ACK)
   \   00000022   0xF89D 0x0008      LDRB     R0,[SP, #+8]
   \   00000026   0x2800             CMP      R0,#+0
   \   00000028   0xD101             BNE.N    ??CASHLESS_adreess_1
     73                return MDB_OK;
   \   0000002A   0x2000             MOVS     R0,#+0
   \   0000002C   0xE002             B.N      ??CASHLESS_adreess_2
     74              
     75              return MDB_ERROR;
   \                     ??CASHLESS_adreess_1:
   \   0000002E   0x2001             MOVS     R0,#+1
   \   00000030   0xE000             B.N      ??CASHLESS_adreess_2
     76            }
     77              
     78            return  MDB_TIMEOUT; 
   \                     ??CASHLESS_adreess_0:
   \   00000032   0x2002             MOVS     R0,#+2
   \                     ??CASHLESS_adreess_2:
   \   00000034   0xBD0E             POP      {R1-R3,PC}       ;; return
     79          }
     80          /***********************************************************************************
     81          *       Descrição       :       Faz o reset da interface de cartão
     82          *       Parametros      :       nenhum
     83          *       Retorno         :       (eMDB_reply) resultado da operação
     84          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     85          eMDB_reply CASHLESS_reset_device(void){
   \                     CASHLESS_reset_device:
   \   00000000   0xB5E0             PUSH     {R5-R7,LR}
     86            unsigned char buffer[2];
     87            unsigned char recebidos;
     88            
     89            buffer[0] = CASHLESS_RESET;
   \   00000002   0x2010             MOVS     R0,#+16
   \   00000004   0xF88D 0x0008      STRB     R0,[SP, #+8]
     90            
     91            if(MDB_send_package(1,buffer,1,0,buffer,&recebidos)==MDB_OK){
   \   00000008   0xF10D 0x000A      ADD      R0,SP,#+10
   \   0000000C   0x9001             STR      R0,[SP, #+4]
   \   0000000E   0xA802             ADD      R0,SP,#+8
   \   00000010   0x9000             STR      R0,[SP, #+0]
   \   00000012   0x2300             MOVS     R3,#+0
   \   00000014   0x2201             MOVS     R2,#+1
   \   00000016   0xA902             ADD      R1,SP,#+8
   \   00000018   0x2001             MOVS     R0,#+1
   \   0000001A   0x.... 0x....      BL       MDB_send_package
   \   0000001E   0x2800             CMP      R0,#+0
   \   00000020   0xD107             BNE.N    ??CASHLESS_reset_device_0
     92                  
     93              if(buffer[0]==MDB_RESP_ACK)
   \   00000022   0xF89D 0x0008      LDRB     R0,[SP, #+8]
   \   00000026   0x2800             CMP      R0,#+0
   \   00000028   0xD101             BNE.N    ??CASHLESS_reset_device_1
     94                return MDB_OK;
   \   0000002A   0x2000             MOVS     R0,#+0
   \   0000002C   0xE002             B.N      ??CASHLESS_reset_device_2
     95              
     96              return MDB_ERROR;
   \                     ??CASHLESS_reset_device_1:
   \   0000002E   0x2001             MOVS     R0,#+1
   \   00000030   0xE000             B.N      ??CASHLESS_reset_device_2
     97            }
     98              
     99            return  MDB_TIMEOUT; 
   \                     ??CASHLESS_reset_device_0:
   \   00000032   0x2002             MOVS     R0,#+2
   \                     ??CASHLESS_reset_device_2:
   \   00000034   0xBD0E             POP      {R1-R3,PC}       ;; return
    100          }
    101          /***********************************************************************************
    102          *       Descrição       :     Lê e escreve nas configurações do cashless
    103          *       Parametros      :     (unsigned char) nível mdb
    104          *                             (unsigned char) quantidade de colunas do display
    105          *                             (unsigned char) quantidade de linhas do display
    106          *                             (eMDB_DISPLAY_INFO) informação sobre o display
    107          *                             (unsigned char*) nível configuraod
    108          *                             (unsigned short int*) pais
    109          *                             (unsigned char*) fator de escala
    110          *                             (unsigned char*) casas decimais
    111          *                             (unsigned char*) tempo máximo para transação
    112          *                             (unsigned char*) opções gerais
    113          *       Retorno         :     (eMDB_reply) resultado da operação
    114          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    115          eMDB_reply CASHLESS_set_and_get_setup_from_to_device(unsigned char nivel_mdb,
    116                                                               unsigned char linhas_lcd,
    117                                                               unsigned char colunas_lcd,
    118                                                               eMDB_DISPLAY_INFO info_lcd,                                                     
    119                                                               unsigned char *nivel_configurado,
    120                                                               unsigned short int*pais,
    121                                                               unsigned char *escala,
    122                                                               unsigned char *casas_decimais,
    123                                                               unsigned char *tempo_maximo_transacao,
    124                                                               unsigned char *opcoes_gerais){
   \                     CASHLESS_set_and_get_setup_from_to_device:
   \   00000000   0xE92D 0x4FF3      PUSH     {R0,R1,R4-R11,LR}
   \   00000004   0xB08D             SUB      SP,SP,#+52
   \   00000006   0x0014             MOVS     R4,R2
   \   00000008   0x001D             MOVS     R5,R3
   \   0000000A   0x9E18             LDR      R6,[SP, #+96]
   \   0000000C   0x9F19             LDR      R7,[SP, #+100]
   \   0000000E   0xF8DD 0x8068      LDR      R8,[SP, #+104]
   \   00000012   0xF8DD 0x906C      LDR      R9,[SP, #+108]
   \   00000016   0xF8DD 0xA070      LDR      R10,[SP, #+112]
   \   0000001A   0xF8DD 0xB074      LDR      R11,[SP, #+116]
    125            unsigned char buffer[36];
    126            unsigned char recebidos;
    127            
    128            buffer[0] = CASHLESS_SETUP;
   \   0000001E   0x2011             MOVS     R0,#+17
   \   00000020   0xF88D 0x000C      STRB     R0,[SP, #+12]
    129            buffer[1] = 0x00;// Config DATA
   \   00000024   0x2000             MOVS     R0,#+0
   \   00000026   0xF88D 0x000D      STRB     R0,[SP, #+13]
    130            buffer[2] = 0x01;// Nivel da comunicação
   \   0000002A   0x2001             MOVS     R0,#+1
   \   0000002C   0xF88D 0x000E      STRB     R0,[SP, #+14]
    131            buffer[3] = 16;   // Colunas do LCD
   \   00000030   0x2010             MOVS     R0,#+16
   \   00000032   0xF88D 0x000F      STRB     R0,[SP, #+15]
    132            buffer[4] = 2;    // Linhas do LCD
   \   00000036   0x2002             MOVS     R0,#+2
   \   00000038   0xF88D 0x0010      STRB     R0,[SP, #+16]
    133            buffer[5] = 1;    // full ascii display
   \   0000003C   0x2001             MOVS     R0,#+1
   \   0000003E   0xF88D 0x0011      STRB     R0,[SP, #+17]
    134            
    135            if(MDB_send_package(1,buffer,6,1,buffer,&recebidos)==MDB_OK){
   \   00000042   0xA802             ADD      R0,SP,#+8
   \   00000044   0x9001             STR      R0,[SP, #+4]
   \   00000046   0xA803             ADD      R0,SP,#+12
   \   00000048   0x9000             STR      R0,[SP, #+0]
   \   0000004A   0x2301             MOVS     R3,#+1
   \   0000004C   0x2206             MOVS     R2,#+6
   \   0000004E   0xA903             ADD      R1,SP,#+12
   \   00000050   0x2001             MOVS     R0,#+1
   \   00000052   0x.... 0x....      BL       MDB_send_package
   \   00000056   0x2800             CMP      R0,#+0
   \   00000058   0xD135             BNE.N    ??CASHLESS_set_and_get_setup_from_to_device_0
    136                  
    137              if(buffer[0]==0x01 && recebidos>1){
   \   0000005A   0xF89D 0x000C      LDRB     R0,[SP, #+12]
   \   0000005E   0x2801             CMP      R0,#+1
   \   00000060   0xD12F             BNE.N    ??CASHLESS_set_and_get_setup_from_to_device_1
   \   00000062   0xF89D 0x0008      LDRB     R0,[SP, #+8]
   \   00000066   0x2802             CMP      R0,#+2
   \   00000068   0xDB2B             BLT.N    ??CASHLESS_set_and_get_setup_from_to_device_1
    138                
    139                if(nivel_configurado!=NULL)
   \   0000006A   0x2E00             CMP      R6,#+0
   \   0000006C   0xD002             BEQ.N    ??CASHLESS_set_and_get_setup_from_to_device_2
    140                  *nivel_configurado = buffer[Z2];
   \   0000006E   0xF89D 0x000D      LDRB     R0,[SP, #+13]
   \   00000072   0x7030             STRB     R0,[R6, #+0]
    141                
    142                if(pais!=NULL)
   \                     ??CASHLESS_set_and_get_setup_from_to_device_2:
   \   00000074   0x2F00             CMP      R7,#+0
   \   00000076   0xD006             BEQ.N    ??CASHLESS_set_and_get_setup_from_to_device_3
    143                  *pais = buffer[Z3]<<8 | buffer[Z4];
   \   00000078   0xF89D 0x000E      LDRB     R0,[SP, #+14]
   \   0000007C   0xF89D 0x100F      LDRB     R1,[SP, #+15]
   \   00000080   0xEA51 0x2000      ORRS     R0,R1,R0, LSL #+8
   \   00000084   0x8038             STRH     R0,[R7, #+0]
    144                
    145                if(escala!=NULL)
   \                     ??CASHLESS_set_and_get_setup_from_to_device_3:
   \   00000086   0xF1B8 0x0F00      CMP      R8,#+0
   \   0000008A   0xD003             BEQ.N    ??CASHLESS_set_and_get_setup_from_to_device_4
    146                  *escala = buffer[Z5];
   \   0000008C   0xF89D 0x0010      LDRB     R0,[SP, #+16]
   \   00000090   0xF888 0x0000      STRB     R0,[R8, #+0]
    147                
    148                if(casas_decimais!=NULL)
   \                     ??CASHLESS_set_and_get_setup_from_to_device_4:
   \   00000094   0xF1B9 0x0F00      CMP      R9,#+0
   \   00000098   0xD003             BEQ.N    ??CASHLESS_set_and_get_setup_from_to_device_5
    149                  *casas_decimais = buffer[Z6];
   \   0000009A   0xF89D 0x0011      LDRB     R0,[SP, #+17]
   \   0000009E   0xF889 0x0000      STRB     R0,[R9, #+0]
    150                
    151                if(tempo_maximo_transacao!=NULL)
   \                     ??CASHLESS_set_and_get_setup_from_to_device_5:
   \   000000A2   0xF1BA 0x0F00      CMP      R10,#+0
   \   000000A6   0xD003             BEQ.N    ??CASHLESS_set_and_get_setup_from_to_device_6
    152                  *tempo_maximo_transacao = buffer[Z7];
   \   000000A8   0xF89D 0x0012      LDRB     R0,[SP, #+18]
   \   000000AC   0xF88A 0x0000      STRB     R0,[R10, #+0]
    153                
    154                if(opcoes_gerais!=NULL)
   \                     ??CASHLESS_set_and_get_setup_from_to_device_6:
   \   000000B0   0xF1BB 0x0F00      CMP      R11,#+0
   \   000000B4   0xD003             BEQ.N    ??CASHLESS_set_and_get_setup_from_to_device_7
    155                  *opcoes_gerais = buffer[Z8];      
   \   000000B6   0xF89D 0x0013      LDRB     R0,[SP, #+19]
   \   000000BA   0xF88B 0x0000      STRB     R0,[R11, #+0]
    156                
    157                return MDB_OK;  
   \                     ??CASHLESS_set_and_get_setup_from_to_device_7:
   \   000000BE   0x2000             MOVS     R0,#+0
   \   000000C0   0xE002             B.N      ??CASHLESS_set_and_get_setup_from_to_device_8
    158              }
    159              
    160              return MDB_ERROR;
   \                     ??CASHLESS_set_and_get_setup_from_to_device_1:
   \   000000C2   0x2001             MOVS     R0,#+1
   \   000000C4   0xE000             B.N      ??CASHLESS_set_and_get_setup_from_to_device_8
    161            }
    162              
    163            return  MDB_TIMEOUT;                                                                                                  
   \                     ??CASHLESS_set_and_get_setup_from_to_device_0:
   \   000000C6   0x2002             MOVS     R0,#+2
   \                     ??CASHLESS_set_and_get_setup_from_to_device_8:
   \   000000C8   0xB00F             ADD      SP,SP,#+60
   \   000000CA   0xE8BD 0x8FF0      POP      {R4-R11,PC}      ;; return
    164          }
    165          /***********************************************************************************
    166          *       Descrição       :       Configura o preço mínimo e máximo do produto
    167          *       Parametros      :       (unsigned short int) mínimo
    168          *                               (unsigned short int) máximo
    169          *       Retorno         :       (eMDB_reply) resultado da operação
    170          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    171          eMDB_reply CASHLESS_set_min_and_max_price_in_device(unsigned short int min,
    172                                                              unsigned short int max){
   \                     CASHLESS_set_min_and_max_price_in_device:
   \   00000000   0xB530             PUSH     {R4,R5,LR}
   \   00000002   0xB08D             SUB      SP,SP,#+52
   \   00000004   0x0005             MOVS     R5,R0
   \   00000006   0x000C             MOVS     R4,R1
    173            unsigned char buffer[36];
    174            unsigned char recebidos;
    175            
    176            min*=100;
   \   00000008   0x2064             MOVS     R0,#+100
   \   0000000A   0x4345             MULS     R5,R0,R5
    177            max*=100;
   \   0000000C   0x2064             MOVS     R0,#+100
   \   0000000E   0x4344             MULS     R4,R0,R4
    178            
    179            buffer[0] = CASHLESS_SETUP;
   \   00000010   0x2011             MOVS     R0,#+17
   \   00000012   0xF88D 0x000C      STRB     R0,[SP, #+12]
    180            buffer[1] = 0x01;
   \   00000016   0x2001             MOVS     R0,#+1
   \   00000018   0xF88D 0x000D      STRB     R0,[SP, #+13]
    181            buffer[2] = max>>8;
   \   0000001C   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   0000001E   0x0A20             LSRS     R0,R4,#+8
   \   00000020   0xF88D 0x000E      STRB     R0,[SP, #+14]
    182            buffer[3] = max>>16;
   \   00000024   0x2000             MOVS     R0,#+0
   \   00000026   0xF88D 0x000F      STRB     R0,[SP, #+15]
    183            buffer[4] = min>>8;
   \   0000002A   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   0000002C   0x0A28             LSRS     R0,R5,#+8
   \   0000002E   0xF88D 0x0010      STRB     R0,[SP, #+16]
    184            buffer[5] = min;
   \   00000032   0x0028             MOVS     R0,R5
   \   00000034   0xF88D 0x0011      STRB     R0,[SP, #+17]
    185            
    186            if(MDB_send_package(1,buffer,6,0,buffer,&recebidos)==MDB_OK){
   \   00000038   0xA802             ADD      R0,SP,#+8
   \   0000003A   0x9001             STR      R0,[SP, #+4]
   \   0000003C   0xA803             ADD      R0,SP,#+12
   \   0000003E   0x9000             STR      R0,[SP, #+0]
   \   00000040   0x2300             MOVS     R3,#+0
   \   00000042   0x2206             MOVS     R2,#+6
   \   00000044   0xA903             ADD      R1,SP,#+12
   \   00000046   0x2001             MOVS     R0,#+1
   \   00000048   0x.... 0x....      BL       MDB_send_package
   \   0000004C   0x2800             CMP      R0,#+0
   \   0000004E   0xD107             BNE.N    ??CASHLESS_set_min_and_max_price_in_device_0
    187                  
    188              if(buffer[0]==MDB_RESP_ACK)
   \   00000050   0xF89D 0x000C      LDRB     R0,[SP, #+12]
   \   00000054   0x2800             CMP      R0,#+0
   \   00000056   0xD101             BNE.N    ??CASHLESS_set_min_and_max_price_in_device_1
    189                return MDB_OK;
   \   00000058   0x2000             MOVS     R0,#+0
   \   0000005A   0xE002             B.N      ??CASHLESS_set_min_and_max_price_in_device_2
    190              
    191              return MDB_ERROR;
   \                     ??CASHLESS_set_min_and_max_price_in_device_1:
   \   0000005C   0x2001             MOVS     R0,#+1
   \   0000005E   0xE000             B.N      ??CASHLESS_set_min_and_max_price_in_device_2
    192            }
    193              
    194            return  MDB_TIMEOUT;                                                    
   \                     ??CASHLESS_set_min_and_max_price_in_device_0:
   \   00000060   0x2002             MOVS     R0,#+2
   \                     ??CASHLESS_set_min_and_max_price_in_device_2:
   \   00000062   0xB00D             ADD      SP,SP,#+52
   \   00000064   0xBD30             POP      {R4,R5,PC}       ;; return
    195          }
    196          /***********************************************************************************
    197          *       Descrição       :       Pool do dispositivo
    198          *       Parametros      :       nenhum
    199          *       Retorno         :       (eMDB_reply) resultado da operçaão
    200          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    201          eMDB_reply CASHLESS_poll_device(eMDB_POLL_HEADER *header,unsigned char *args){
   \                     CASHLESS_poll_device:
   \   00000000   0xB53E             PUSH     {R1-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    202            unsigned char buffer[2];
    203            unsigned char recebidos;
    204            
    205            buffer[0] = CASHLESS_POLL;
   \   00000006   0x2012             MOVS     R0,#+18
   \   00000008   0xF88D 0x0008      STRB     R0,[SP, #+8]
    206            
    207            if(MDB_send_package(1,buffer,1,0,buffer,&recebidos)==MDB_OK){
   \   0000000C   0xF10D 0x000A      ADD      R0,SP,#+10
   \   00000010   0x9001             STR      R0,[SP, #+4]
   \   00000012   0xA802             ADD      R0,SP,#+8
   \   00000014   0x9000             STR      R0,[SP, #+0]
   \   00000016   0x2300             MOVS     R3,#+0
   \   00000018   0x2201             MOVS     R2,#+1
   \   0000001A   0xA902             ADD      R1,SP,#+8
   \   0000001C   0x2001             MOVS     R0,#+1
   \   0000001E   0x.... 0x....      BL       MDB_send_package
   \   00000022   0x2800             CMP      R0,#+0
   \   00000024   0xD15D             BNE.N    ??CASHLESS_poll_device_0
    208                      
    209              switch(buffer[0]){
   \   00000026   0xF89D 0x0008      LDRB     R0,[SP, #+8]
   \   0000002A   0x2800             CMP      R0,#+0
   \   0000002C   0xD022             BEQ.N    ??CASHLESS_poll_device_1
   \   0000002E   0x2801             CMP      R0,#+1
   \   00000030   0xD023             BEQ.N    ??CASHLESS_poll_device_2
   \   00000032   0x2802             CMP      R0,#+2
   \   00000034   0xD024             BEQ.N    ??CASHLESS_poll_device_3
   \   00000036   0x2803             CMP      R0,#+3
   \   00000038   0xD025             BEQ.N    ??CASHLESS_poll_device_4
   \   0000003A   0x2804             CMP      R0,#+4
   \   0000003C   0xD026             BEQ.N    ??CASHLESS_poll_device_5
   \   0000003E   0x2805             CMP      R0,#+5
   \   00000040   0xD027             BEQ.N    ??CASHLESS_poll_device_6
   \   00000042   0x2806             CMP      R0,#+6
   \   00000044   0xD028             BEQ.N    ??CASHLESS_poll_device_7
   \   00000046   0x2807             CMP      R0,#+7
   \   00000048   0xD029             BEQ.N    ??CASHLESS_poll_device_8
   \   0000004A   0x2808             CMP      R0,#+8
   \   0000004C   0xD02A             BEQ.N    ??CASHLESS_poll_device_9
   \   0000004E   0x2809             CMP      R0,#+9
   \   00000050   0xD02B             BEQ.N    ??CASHLESS_poll_device_10
   \   00000052   0x280A             CMP      R0,#+10
   \   00000054   0xD02C             BEQ.N    ??CASHLESS_poll_device_11
   \   00000056   0x280B             CMP      R0,#+11
   \   00000058   0xD02D             BEQ.N    ??CASHLESS_poll_device_12
   \   0000005A   0x280D             CMP      R0,#+13
   \   0000005C   0xD02E             BEQ.N    ??CASHLESS_poll_device_13
   \   0000005E   0x280E             CMP      R0,#+14
   \   00000060   0xD02F             BEQ.N    ??CASHLESS_poll_device_14
   \   00000062   0x280F             CMP      R0,#+15
   \   00000064   0xD030             BEQ.N    ??CASHLESS_poll_device_15
   \   00000066   0x2810             CMP      R0,#+16
   \   00000068   0xD031             BEQ.N    ??CASHLESS_poll_device_16
   \   0000006A   0x2811             CMP      R0,#+17
   \   0000006C   0xD032             BEQ.N    ??CASHLESS_poll_device_17
   \   0000006E   0x2812             CMP      R0,#+18
   \   00000070   0xD033             BEQ.N    ??CASHLESS_poll_device_18
   \   00000072   0xE034             B.N      ??CASHLESS_poll_device_19
    210                case CASHLESS_POOL_JUST_RESET:
    211                     *header = CASHLESS_POOL_JUST_RESET;
   \                     ??CASHLESS_poll_device_1:
   \   00000074   0x2000             MOVS     R0,#+0
   \   00000076   0x7020             STRB     R0,[R4, #+0]
    212                     break;
   \   00000078   0xE031             B.N      ??CASHLESS_poll_device_19
    213                case CASHLESS_POOL_READER_CONFIG_DATA:
    214                     *header = CASHLESS_POOL_READER_CONFIG_DATA;
   \                     ??CASHLESS_poll_device_2:
   \   0000007A   0x2001             MOVS     R0,#+1
   \   0000007C   0x7020             STRB     R0,[R4, #+0]
    215                     break;
   \   0000007E   0xE02E             B.N      ??CASHLESS_poll_device_19
    216                case CASHLESS_POOL_DISPLAY_REQUEST:
    217                     *header = CASHLESS_POOL_DISPLAY_REQUEST;
   \                     ??CASHLESS_poll_device_3:
   \   00000080   0x2002             MOVS     R0,#+2
   \   00000082   0x7020             STRB     R0,[R4, #+0]
    218                     break;
   \   00000084   0xE02B             B.N      ??CASHLESS_poll_device_19
    219                case CASHLESS_POOL_BEGIN_SESSION:
    220                     *header = CASHLESS_POOL_BEGIN_SESSION;
   \                     ??CASHLESS_poll_device_4:
   \   00000086   0x2003             MOVS     R0,#+3
   \   00000088   0x7020             STRB     R0,[R4, #+0]
    221                     break;
   \   0000008A   0xE028             B.N      ??CASHLESS_poll_device_19
    222                case CASHLESS_POOL_SESSION_CANCEL_REQUEST:
    223                     *header = CASHLESS_POOL_SESSION_CANCEL_REQUEST;
   \                     ??CASHLESS_poll_device_5:
   \   0000008C   0x2004             MOVS     R0,#+4
   \   0000008E   0x7020             STRB     R0,[R4, #+0]
    224                     break;
   \   00000090   0xE025             B.N      ??CASHLESS_poll_device_19
    225                case CASHLESS_POOL_VEND_APPROVED:
    226                     *header = CASHLESS_POOL_VEND_APPROVED;
   \                     ??CASHLESS_poll_device_6:
   \   00000092   0x2005             MOVS     R0,#+5
   \   00000094   0x7020             STRB     R0,[R4, #+0]
    227                     break;
   \   00000096   0xE022             B.N      ??CASHLESS_poll_device_19
    228                case CASHLESS_POOL_VEND_DENIED:
    229                     *header = CASHLESS_POOL_VEND_DENIED;
   \                     ??CASHLESS_poll_device_7:
   \   00000098   0x2006             MOVS     R0,#+6
   \   0000009A   0x7020             STRB     R0,[R4, #+0]
    230                     break;
   \   0000009C   0xE01F             B.N      ??CASHLESS_poll_device_19
    231                case CASHLESS_POOL_END_SESSION:
    232                     *header = CASHLESS_POOL_END_SESSION;
   \                     ??CASHLESS_poll_device_8:
   \   0000009E   0x2007             MOVS     R0,#+7
   \   000000A0   0x7020             STRB     R0,[R4, #+0]
    233                     break;
   \   000000A2   0xE01C             B.N      ??CASHLESS_poll_device_19
    234                case CASHLESS_POOL_CANCELLED:
    235                     *header = CASHLESS_POOL_CANCELLED;
   \                     ??CASHLESS_poll_device_9:
   \   000000A4   0x2008             MOVS     R0,#+8
   \   000000A6   0x7020             STRB     R0,[R4, #+0]
    236                     break;
   \   000000A8   0xE019             B.N      ??CASHLESS_poll_device_19
    237                case CASHLESS_POOL_PERIPHERAL_ID:
    238                     *header = CASHLESS_POOL_PERIPHERAL_ID;
   \                     ??CASHLESS_poll_device_10:
   \   000000AA   0x2009             MOVS     R0,#+9
   \   000000AC   0x7020             STRB     R0,[R4, #+0]
    239                     break;
   \   000000AE   0xE016             B.N      ??CASHLESS_poll_device_19
    240                case CASHLESS_POOL_MALFUNCTION:
    241                     *header = CASHLESS_POOL_MALFUNCTION;
   \                     ??CASHLESS_poll_device_11:
   \   000000B0   0x200A             MOVS     R0,#+10
   \   000000B2   0x7020             STRB     R0,[R4, #+0]
    242                     break;
   \   000000B4   0xE013             B.N      ??CASHLESS_poll_device_19
    243                case CASHLESS_POOL_CMD_OUT_OF_SEQUENCE:
    244                     *header = CASHLESS_POOL_CMD_OUT_OF_SEQUENCE;
   \                     ??CASHLESS_poll_device_12:
   \   000000B6   0x200B             MOVS     R0,#+11
   \   000000B8   0x7020             STRB     R0,[R4, #+0]
    245                     break;
   \   000000BA   0xE010             B.N      ??CASHLESS_poll_device_19
    246                case CASHLESS_POOL_REVALUE_APPROVED:
    247                     *header = CASHLESS_POOL_REVALUE_APPROVED;
   \                     ??CASHLESS_poll_device_13:
   \   000000BC   0x200D             MOVS     R0,#+13
   \   000000BE   0x7020             STRB     R0,[R4, #+0]
    248                     break;
   \   000000C0   0xE00D             B.N      ??CASHLESS_poll_device_19
    249                case CASHLESS_POOL_REVALUE_DENIED:
    250                     *header = CASHLESS_POOL_REVALUE_DENIED;        
   \                     ??CASHLESS_poll_device_14:
   \   000000C2   0x200E             MOVS     R0,#+14
   \   000000C4   0x7020             STRB     R0,[R4, #+0]
    251                     break;
   \   000000C6   0xE00A             B.N      ??CASHLESS_poll_device_19
    252                case CASHLESS_POOL_REVALUE_LIMIT_AMOUNT:
    253                     *header = CASHLESS_POOL_REVALUE_LIMIT_AMOUNT;       
   \                     ??CASHLESS_poll_device_15:
   \   000000C8   0x200F             MOVS     R0,#+15
   \   000000CA   0x7020             STRB     R0,[R4, #+0]
    254                     break;
   \   000000CC   0xE007             B.N      ??CASHLESS_poll_device_19
    255                case CASHLESS_POOL_USER_FILE:
    256                     *header = CASHLESS_POOL_USER_FILE;  
   \                     ??CASHLESS_poll_device_16:
   \   000000CE   0x2010             MOVS     R0,#+16
   \   000000D0   0x7020             STRB     R0,[R4, #+0]
    257                     break;
   \   000000D2   0xE004             B.N      ??CASHLESS_poll_device_19
    258                case CASHLESS_POOL_TIME_DATE_REQUEST:
    259                     *header = CASHLESS_POOL_TIME_DATE_REQUEST;          
   \                     ??CASHLESS_poll_device_17:
   \   000000D4   0x2011             MOVS     R0,#+17
   \   000000D6   0x7020             STRB     R0,[R4, #+0]
    260                     break;
   \   000000D8   0xE001             B.N      ??CASHLESS_poll_device_19
    261                case CASHLESS_DATA_ENTRY:
    262                     *header = CASHLESS_DATA_ENTRY;          
   \                     ??CASHLESS_poll_device_18:
   \   000000DA   0x2012             MOVS     R0,#+18
   \   000000DC   0x7020             STRB     R0,[R4, #+0]
    263                     break;
    264              }
    265                  
    266              
    267              return MDB_OK;
   \                     ??CASHLESS_poll_device_19:
   \   000000DE   0x2000             MOVS     R0,#+0
   \   000000E0   0xE000             B.N      ??CASHLESS_poll_device_20
    268            }
    269              
    270            return  MDB_TIMEOUT;  
   \                     ??CASHLESS_poll_device_0:
   \   000000E2   0x2002             MOVS     R0,#+2
   \                     ??CASHLESS_poll_device_20:
   \   000000E4   0xBD3E             POP      {R1-R5,PC}       ;; return
    271          }
    272          /***********************************************************************************
    273          *       Descrição       :       Envia o comando solicitando um inicio de 
    274          *                               transação
    275          *       Parametros      :       (unsigned short int) valor
    276          *                               (unsigned short int) código do produto
    277          *       Retorno         :       (eMDB_reply) maior do que zero se 
    278          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    279          eMDB_reply MDBCASHLESS_start_vend(eCASHLESS_VEND_RESULT *resultado,
    280                                            unsigned short int *pago,
    281                                            unsigned short int valor,unsigned short int code){
   \                     MDBCASHLESS_start_vend:
   \   00000000   0xB5F0             PUSH     {R4-R7,LR}
   \   00000002   0xB085             SUB      SP,SP,#+20
   \   00000004   0x0004             MOVS     R4,R0
   \   00000006   0x000D             MOVS     R5,R1
   \   00000008   0x0016             MOVS     R6,R2
   \   0000000A   0x001F             MOVS     R7,R3
    282            unsigned char buffer[6];
    283            unsigned char recebidos;                      
    284            
    285            buffer[0] = CASHLESS_VEND;
   \   0000000C   0x2013             MOVS     R0,#+19
   \   0000000E   0xF88D 0x000C      STRB     R0,[SP, #+12]
    286            buffer[1] = REQUEST_VEND;
   \   00000012   0x2000             MOVS     R0,#+0
   \   00000014   0xF88D 0x000D      STRB     R0,[SP, #+13]
    287            buffer[2] = (unsigned char)(valor>>8);
   \   00000018   0xB2B6             UXTH     R6,R6            ;; ZeroExt  R6,R6,#+16,#+16
   \   0000001A   0x0A30             LSRS     R0,R6,#+8
   \   0000001C   0xF88D 0x000E      STRB     R0,[SP, #+14]
    288            buffer[3] = valor;
   \   00000020   0x0030             MOVS     R0,R6
   \   00000022   0xF88D 0x000F      STRB     R0,[SP, #+15]
    289            buffer[4] = (unsigned char)(code>>8);
   \   00000026   0xB2BF             UXTH     R7,R7            ;; ZeroExt  R7,R7,#+16,#+16
   \   00000028   0x0A38             LSRS     R0,R7,#+8
   \   0000002A   0xF88D 0x0010      STRB     R0,[SP, #+16]
    290            buffer[5] = code;
   \   0000002E   0x0038             MOVS     R0,R7
   \   00000030   0xF88D 0x0011      STRB     R0,[SP, #+17]
    291            
    292            *resultado = VEND_DENIED;
   \   00000034   0x2006             MOVS     R0,#+6
   \   00000036   0x7020             STRB     R0,[R4, #+0]
    293            
    294            if(MDB_send_package(1,buffer,6,0,buffer,&recebidos)==MDB_OK){
   \   00000038   0xA802             ADD      R0,SP,#+8
   \   0000003A   0x9001             STR      R0,[SP, #+4]
   \   0000003C   0xA803             ADD      R0,SP,#+12
   \   0000003E   0x9000             STR      R0,[SP, #+0]
   \   00000040   0x2300             MOVS     R3,#+0
   \   00000042   0x2206             MOVS     R2,#+6
   \   00000044   0xA903             ADD      R1,SP,#+12
   \   00000046   0x2001             MOVS     R0,#+1
   \   00000048   0x.... 0x....      BL       MDB_send_package
   \   0000004C   0x2800             CMP      R0,#+0
   \   0000004E   0xD10B             BNE.N    ??MDBCASHLESS_start_vend_0
    295              
    296              *resultado = (eCASHLESS_VEND_RESULT)buffer[Z1];    
   \   00000050   0xF89D 0x000C      LDRB     R0,[SP, #+12]
   \   00000054   0x7020             STRB     R0,[R4, #+0]
    297              *pago = buffer[Z2]<<8 | buffer[Z3];
   \   00000056   0xF89D 0x000D      LDRB     R0,[SP, #+13]
   \   0000005A   0xF89D 0x100E      LDRB     R1,[SP, #+14]
   \   0000005E   0xEA51 0x2000      ORRS     R0,R1,R0, LSL #+8
   \   00000062   0x8028             STRH     R0,[R5, #+0]
    298              
    299              return MDB_OK;
   \   00000064   0x2000             MOVS     R0,#+0
   \   00000066   0xE000             B.N      ??MDBCASHLESS_start_vend_1
    300            }
    301            
    302            return MDB_TIMEOUT;
   \                     ??MDBCASHLESS_start_vend_0:
   \   00000068   0x2002             MOVS     R0,#+2
   \                     ??MDBCASHLESS_start_vend_1:
   \   0000006A   0xB005             ADD      SP,SP,#+20
   \   0000006C   0xBDF0             POP      {R4-R7,PC}       ;; return
    303          }
    304          /***********************************************************************************
    305          *       Descrição       :       Envia o comando para cancelamento da venda
    306          *       Parametros      :       nenhum
    307          *       Retorno         :       (eMDB_reply) se receber resposta
    308          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    309          eMDB_reply MDBCASHLESS_vend_cancel(void){
   \                     MDBCASHLESS_vend_cancel:
   \   00000000   0xB5E0             PUSH     {R5-R7,LR}
    310            unsigned char buffer[2]  ;
    311            unsigned char recebidos;
    312            
    313            buffer[Z1] = CASHLESS_VEND;
   \   00000002   0x2013             MOVS     R0,#+19
   \   00000004   0xF88D 0x0008      STRB     R0,[SP, #+8]
    314            buffer[Z2] = CANCEL_VEND;
   \   00000008   0x2001             MOVS     R0,#+1
   \   0000000A   0xF88D 0x0009      STRB     R0,[SP, #+9]
    315            
    316            if(MDB_send_package(1,buffer,2,0,buffer,&recebidos)==MDB_OK){
   \   0000000E   0xF10D 0x000A      ADD      R0,SP,#+10
   \   00000012   0x9001             STR      R0,[SP, #+4]
   \   00000014   0xA802             ADD      R0,SP,#+8
   \   00000016   0x9000             STR      R0,[SP, #+0]
   \   00000018   0x2300             MOVS     R3,#+0
   \   0000001A   0x2202             MOVS     R2,#+2
   \   0000001C   0xA902             ADD      R1,SP,#+8
   \   0000001E   0x2001             MOVS     R0,#+1
   \   00000020   0x.... 0x....      BL       MDB_send_package
   \   00000024   0x2800             CMP      R0,#+0
   \   00000026   0xD105             BNE.N    ??MDBCASHLESS_vend_cancel_0
    317             
    318              if(buffer[Z1] == VEND_DENIED)
   \   00000028   0xF89D 0x0008      LDRB     R0,[SP, #+8]
   \   0000002C   0x2806             CMP      R0,#+6
   \   0000002E   0xD101             BNE.N    ??MDBCASHLESS_vend_cancel_0
    319                return MDB_OK;
   \   00000030   0x2000             MOVS     R0,#+0
   \   00000032   0xE000             B.N      ??MDBCASHLESS_vend_cancel_1
    320            }
    321            
    322            return MDB_TIMEOUT;
   \                     ??MDBCASHLESS_vend_cancel_0:
   \   00000034   0x2002             MOVS     R0,#+2
   \                     ??MDBCASHLESS_vend_cancel_1:
   \   00000036   0xBD0E             POP      {R1-R3,PC}       ;; return
    323          }
    324          /***********************************************************************************
    325          *       Descrição       :       Sucesso na venda
    326          *       Parametros      :       (unsigned short int) item
    327          *       Retorno         :       (eMDB_reply) se receber resposta
    328          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    329          eMDB_reply MDBCASHLESS_vend_success(unsigned short int item){
   \                     MDBCASHLESS_vend_success:
   \   00000000   0xB51F             PUSH     {R0-R4,LR}
   \   00000002   0x0004             MOVS     R4,R0
    330            unsigned char buffer[4];
    331            unsigned char recebidos;
    332            
    333            buffer[Z1] = CASHLESS_VEND;
   \   00000004   0x2013             MOVS     R0,#+19
   \   00000006   0xF88D 0x000C      STRB     R0,[SP, #+12]
    334            buffer[Z2] = SUCCESS_VEND;
   \   0000000A   0x2002             MOVS     R0,#+2
   \   0000000C   0xF88D 0x000D      STRB     R0,[SP, #+13]
    335            buffer[Z3] = item>>8;
   \   00000010   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   00000012   0x0A20             LSRS     R0,R4,#+8
   \   00000014   0xF88D 0x000E      STRB     R0,[SP, #+14]
    336            buffer[Z4] = item;
   \   00000018   0x0020             MOVS     R0,R4
   \   0000001A   0xF88D 0x000F      STRB     R0,[SP, #+15]
    337            
    338            if(MDB_send_package(1,buffer,4,0,buffer,&recebidos)==MDB_OK){
   \   0000001E   0xA802             ADD      R0,SP,#+8
   \   00000020   0x9001             STR      R0,[SP, #+4]
   \   00000022   0xA803             ADD      R0,SP,#+12
   \   00000024   0x9000             STR      R0,[SP, #+0]
   \   00000026   0x2300             MOVS     R3,#+0
   \   00000028   0x2204             MOVS     R2,#+4
   \   0000002A   0xA903             ADD      R1,SP,#+12
   \   0000002C   0x2001             MOVS     R0,#+1
   \   0000002E   0x.... 0x....      BL       MDB_send_package
   \   00000032   0x2800             CMP      R0,#+0
   \   00000034   0xD101             BNE.N    ??MDBCASHLESS_vend_success_0
    339             
    340              
    341              return MDB_OK;
   \   00000036   0x2000             MOVS     R0,#+0
   \   00000038   0xE000             B.N      ??MDBCASHLESS_vend_success_1
    342            }
    343                
    344            return MDB_TIMEOUT;
   \                     ??MDBCASHLESS_vend_success_0:
   \   0000003A   0x2002             MOVS     R0,#+2
   \                     ??MDBCASHLESS_vend_success_1:
   \   0000003C   0xB004             ADD      SP,SP,#+16
   \   0000003E   0xBD10             POP      {R4,PC}          ;; return
    345          }
    346          /***********************************************************************************
    347          *       Descrição       :       Habilita a leitora
    348          *       Parametros      :       nenhum
    349          *       Retorno         :       (eMDB_reply) se receber a configurmação
    350          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    351          eMDB_reply MDBCASHLESS_enable_reader(unsigned char flag){
   \                     MDBCASHLESS_enable_reader:
   \   00000000   0xB51F             PUSH     {R0-R4,LR}
   \   00000002   0x0004             MOVS     R4,R0
    352            unsigned char buffer[3];
    353            unsigned char recebidos;
    354            
    355            buffer[Z1] = CASHLESS_READER;
   \   00000004   0x2014             MOVS     R0,#+20
   \   00000006   0xF88D 0x000C      STRB     R0,[SP, #+12]
    356            buffer[Z2] = flag?1:0;
   \   0000000A   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000000C   0x2C00             CMP      R4,#+0
   \   0000000E   0xD001             BEQ.N    ??MDBCASHLESS_enable_reader_0
   \   00000010   0x2001             MOVS     R0,#+1
   \   00000012   0xE000             B.N      ??MDBCASHLESS_enable_reader_1
   \                     ??MDBCASHLESS_enable_reader_0:
   \   00000014   0x2000             MOVS     R0,#+0
   \                     ??MDBCASHLESS_enable_reader_1:
   \   00000016   0xF88D 0x000D      STRB     R0,[SP, #+13]
    357            
    358            if(MDB_send_package(1,buffer,2,0,buffer,&recebidos)==MDB_OK){
   \   0000001A   0xA802             ADD      R0,SP,#+8
   \   0000001C   0x9001             STR      R0,[SP, #+4]
   \   0000001E   0xA803             ADD      R0,SP,#+12
   \   00000020   0x9000             STR      R0,[SP, #+0]
   \   00000022   0x2300             MOVS     R3,#+0
   \   00000024   0x2202             MOVS     R2,#+2
   \   00000026   0xA903             ADD      R1,SP,#+12
   \   00000028   0x2001             MOVS     R0,#+1
   \   0000002A   0x.... 0x....      BL       MDB_send_package
   \   0000002E   0x2800             CMP      R0,#+0
   \   00000030   0xD101             BNE.N    ??MDBCASHLESS_enable_reader_2
    359                
    360              return MDB_OK;
   \   00000032   0x2000             MOVS     R0,#+0
   \   00000034   0xE000             B.N      ??MDBCASHLESS_enable_reader_3
    361            }
    362                
    363            return MDB_TIMEOUT;
   \                     ??MDBCASHLESS_enable_reader_2:
   \   00000036   0x2002             MOVS     R0,#+2
   \                     ??MDBCASHLESS_enable_reader_3:
   \   00000038   0xB004             ADD      SP,SP,#+16
   \   0000003A   0xBD10             POP      {R4,PC}          ;; return
    364          }
    365          /***********************************************************************************
    366          *       Descrição       :       Sessão completa
    367          *       Parametros      :       envia o comando se fim da compra
    368          *       Retorno         :       (eMDB_reply) se receber confirmação
    369          ***********************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    370          eMDB_reply MDBCASHLESS_session_complete(void){
   \                     MDBCASHLESS_session_complete:
   \   00000000   0xB500             PUSH     {LR}
   \   00000002   0xB085             SUB      SP,SP,#+20
    371            unsigned char buffer[3];
    372            unsigned char recebidos;
    373            
    374            buffer[Z1] = CASHLESS_VEND;
   \   00000004   0x2013             MOVS     R0,#+19
   \   00000006   0xF88D 0x000C      STRB     R0,[SP, #+12]
    375            buffer[Z2] = SESSION_COMPLETE;
   \   0000000A   0x2004             MOVS     R0,#+4
   \   0000000C   0xF88D 0x000D      STRB     R0,[SP, #+13]
    376            
    377            if(MDB_send_package(1,buffer,2,0,buffer,&recebidos)==MDB_OK){
   \   00000010   0xA802             ADD      R0,SP,#+8
   \   00000012   0x9001             STR      R0,[SP, #+4]
   \   00000014   0xA803             ADD      R0,SP,#+12
   \   00000016   0x9000             STR      R0,[SP, #+0]
   \   00000018   0x2300             MOVS     R3,#+0
   \   0000001A   0x2202             MOVS     R2,#+2
   \   0000001C   0xA903             ADD      R1,SP,#+12
   \   0000001E   0x2001             MOVS     R0,#+1
   \   00000020   0x.... 0x....      BL       MDB_send_package
   \   00000024   0x2800             CMP      R0,#+0
   \   00000026   0xD101             BNE.N    ??MDBCASHLESS_session_complete_0
    378                
    379              return MDB_OK;
   \   00000028   0x2000             MOVS     R0,#+0
   \   0000002A   0xE000             B.N      ??MDBCASHLESS_session_complete_1
    380            }
    381                
    382            return MDB_TIMEOUT;
   \                     ??MDBCASHLESS_session_complete_0:
   \   0000002C   0x2002             MOVS     R0,#+2
   \                     ??MDBCASHLESS_session_complete_1:
   \   0000002E   0xB005             ADD      SP,SP,#+20
   \   00000030   0xBD00             POP      {PC}             ;; return
    383          }
    384          /***********************************************************************************
    385          *       Fim do arquivo
    386          ***********************************************************************************/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      16   CASHLESS_adreess
        16   -> MDB_send_package
      24   CASHLESS_poll_device
        24   -> MDB_send_package
      16   CASHLESS_reset_device
        16   -> MDB_send_package
      96   CASHLESS_set_and_get_setup_from_to_device
        96   -> MDB_send_package
      64   CASHLESS_set_min_and_max_price_in_device
        64   -> MDB_send_package
      24   MDBCASHLESS_enable_reader
        24   -> MDB_send_package
      24   MDBCASHLESS_session_complete
        24   -> MDB_send_package
      40   MDBCASHLESS_start_vend
        40   -> MDB_send_package
      16   MDBCASHLESS_vend_cancel
        16   -> MDB_send_package
      24   MDBCASHLESS_vend_success
        24   -> MDB_send_package


   Section sizes:

   Bytes  Function/Label
   -----  --------------
      54  CASHLESS_adreess
     230  CASHLESS_poll_device
      54  CASHLESS_reset_device
     206  CASHLESS_set_and_get_setup_from_to_device
     102  CASHLESS_set_min_and_max_price_in_device
      60  MDBCASHLESS_enable_reader
      50  MDBCASHLESS_session_complete
     110  MDBCASHLESS_start_vend
      56  MDBCASHLESS_vend_cancel
      64  MDBCASHLESS_vend_success

 
 986 bytes in section .text
 
 986 bytes of CODE memory

Errors: none
Warnings: none
